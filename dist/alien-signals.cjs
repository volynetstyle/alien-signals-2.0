"use strict";var E=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var J=Object.prototype.hasOwnProperty;var K=(e,n)=>{for(var t in n)E(e,t,{get:n[t],enumerable:!0})},Q=(e,n,t,l)=>{if(n&&typeof n=="object"||typeof n=="function")for(let h of H(n))!J.call(e,h)&&h!==t&&E(e,h,{get:()=>n[h],enumerable:!(l=G(n,h))||l.enumerable});return e};var U=e=>Q(E({},"__esModule",{value:!0}),e);var oe={};K(oe,{ReactiveFlags:()=>N,computed:()=>te,createReactiveSystem:()=>C,effect:()=>de,effectScope:()=>ue,endBatch:()=>_,getActiveSub:()=>X,getBatchDepth:()=>Y,isComputed:()=>F,isEffect:()=>ee,isEffectScope:()=>ne,isSignal:()=>$,setActiveSub:()=>v,signal:()=>ie,startBatch:()=>Z,trigger:()=>se});module.exports=U(oe);var N=(a=>(a[a.None=0]="None",a[a.Mutable=1]="Mutable",a[a.Watching=2]="Watching",a[a.RecursedCheck=3]="RecursedCheck",a[a.Recursed=4]="Recursed",a[a.Dirty=5]="Dirty",a[a.Pending=6]="Pending",a))(N||{});function C({update:e,notify:n,unwatched:t}){return{link:l,unlink:h,propagate:T,checkDirty:z,shallowPropagate:a,isValidLink:P};function l(i,d,s){let f=d.depsTail;if(f!==void 0&&f.dep===i)return;let u=i.subsTail;if(u!==void 0&&u.version===s&&u.sub===d)return;let r=d.deps,o;if(f!==void 0){if(o=f.nextDep,o!==void 0&&o.dep===i){o.version=s,o.depEpoch=d.depsEpoch,d.depsTail=o;return}}else if(o=r,o!==void 0&&o.dep===i){o.version=s,o.depEpoch=d.depsEpoch,d.depsTail=o;return}let c={dep:i,sub:d,prevDep:f,nextDep:void 0,prevSub:u,nextSub:void 0,version:s,depEpoch:d.depsEpoch};f!==void 0?f.nextDep=c:d.deps=c,d.depsTail=c,u!==void 0?u.nextSub=c:i.subs=c,i.subsTail=c}function h(i,d=i.sub){let s=i.dep,f=i.nextDep,u=i.prevDep,r=i.nextSub,o=i.prevSub;if(u!==void 0?u.nextDep=f:d.deps=f,f!==void 0?f.prevDep=u:d.depsTail=u,o!==void 0)o.nextSub=r;else if(s.subs=r,r===void 0)return s.subsTail=void 0,t(s),f;return r!==void 0?r.prevSub=o:s.subsTail=o,f}function T(i){let d=i.nextSub,s;e:do{let f=i.sub,u=f.flags;if(u&7?u&7?u&3?!(u&7)&&P(i,f)?(f.flags=u|6,u&=1):u=0:f.flags=u&-5|6:u=0:f.flags=u|6,u&2&&n(f),u&1){let r=f.subs;if(r!==void 0){let o=(i=r).nextSub;o!==void 0&&(s={value:d,prev:s},d=o);continue}}if((i=d)!==void 0){d=i.nextSub;continue}for(;s!==void 0;)if(i=s.value,s=s.prev,i!==void 0){d=i.nextSub;continue e}break}while(!0)}function z(i,d){let s,f=0,u=!1;e:do{let r=i.dep,o=r.flags;if(d.flags&5)u=!0;else if((o&5)===5){if(e(r)){let c=r.subs;c.nextSub!==void 0&&a(c),u=!0}}else if((o&7)===7){(i.nextSub!==void 0||i.prevSub!==void 0)&&(s={value:i,prev:s}),i=r.deps,d=r,++f;continue}if(!u){let c=i.nextDep;if(c!==void 0){i=c;continue}}for(;f--;){let c=d.subs,V=c.nextSub!==void 0;if(V?(i=s.value,s=s.prev):i=c,u){if(e(d)){V&&a(c),d=i.sub;continue}u=!1}else d.flags&=-7;d=i.sub;let L=i.nextDep;if(L!==void 0){i=L;continue e}}return u}while(!0)}function a(i){do{let d=i.sub,s=d.flags;(s&7)===6&&(d.flags=s|5,(s&3)===2&&n(d))}while((i=i.nextSub)!==void 0)}function P(i,d){return i.sub===d&&i.depEpoch===d.depsEpoch}}var y=0,S=0,g=0,x=0,p,b=[],{link:D,unlink:w,propagate:W,checkDirty:I,shallowPropagate:k}=C({update(e){return e.depsTail!==void 0?O(e):B(e)},notify(e){let n=x,t=n;do if(b[n++]=e,e.flags&=-3,e=e.subs?.sub,e===void 0||!(e.flags&2))break;while(!0);for(x=n;t<--n;){let l=b[t];b[t++]=b[n],b[n]=l}},unwatched(e){e.flags&1?e.depsTail!==void 0&&(e.depsTail=void 0,e.flags=5,R(e)):m.call(e)}});function X(){return p}function v(e){let n=p;return p=e,n}function Y(){return S}function Z(){++S}function _(){--S||M()}function $(e){return e.name==="bound "+A.name}function F(e){return e.name==="bound "+q.name}function ee(e){return e.name==="bound "+j.name}function ne(e){return e.name==="bound "+m.name}function ie(e){return A.bind({currentValue:e,pendingValue:e,deps:void 0,depsTail:void 0,subs:void 0,subsTail:void 0,flags:1,depsEpoch:0})}function te(e){return q.bind({value:void 0,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:0,depsEpoch:0,getter:e})}function de(e){let n={fn:e,subs:void 0,subsTail:void 0,deps:void 0,depsTail:void 0,flags:3,depsEpoch:0},t=v(n);t!==void 0&&D(n,t,0);try{n.fn()}finally{p=t,n.flags&=-4}return j.bind(n)}function ue(e){let n={deps:void 0,depsTail:void 0,subs:void 0,subsTail:void 0,flags:0,depsEpoch:0},t=v(n);t!==void 0&&D(n,t,0);try{e()}finally{p=t}return m.bind(n)}function se(e){let n={deps:void 0,depsTail:void 0,subs:void 0,subsTail:void 0,flags:2,depsEpoch:0},t=v(n);try{e()}finally{p=t;let l=n.deps;for(;l!==void 0;){let h=l.dep;l=w(l,n);let T=h.subs;T!==void 0&&(n.flags=0,W(T),k(T))}S||M()}}function O(e){++y,++e.depsEpoch,e.depsTail=void 0,e.flags=3;let n=v(e);try{let t=e.value;return t!==(e.value=e.getter(t))}finally{p=n,e.flags&=-4,R(e)}}function B(e){return e.flags=1,e.currentValue!==(e.currentValue=e.pendingValue)}function fe(e){let n=e.flags;if(n&5||n&6&&I(e.deps,e)){++y,++e.depsEpoch,e.depsTail=void 0,e.flags=3;let t=v(e);try{e.fn()}finally{p=t,e.flags&=-4,R(e)}}else e.flags=2}function M(){try{for(;g<x;){let e=b[g];b[g++]=void 0,fe(e)}}finally{for(;g<x;){let e=b[g];b[g++]=void 0,e.flags|=6}g=0,x=0}}function q(){let e=this.flags;if(e&5||e&6&&(I(this.deps,this)||(this.flags=e&-7,!1))){if(O(this)){let t=this.subs;t!==void 0&&k(t)}}else if(!e){this.flags=3;let t=v(this);try{this.value=this.getter()}finally{p=t,this.flags&=-4}}let n=p;return n!==void 0&&D(this,n,y),this.value}function A(...e){if(e.length){if(this.pendingValue!==(this.pendingValue=e[0])){this.flags=5;let n=this.subs;n!==void 0&&(W(n),S||M())}}else{if(this.flags&5&&B(this)){let t=this.subs;t!==void 0&&k(t)}let n=p;for(;n!==void 0;){if(n.flags&3){D(this,n,y);break}n=n.subs?.sub}return this.currentValue}}function j(){m.call(this)}function m(){this.depsTail=void 0,this.flags=0,R(this);let e=this.subs;e!==void 0&&w(e)}function R(e){let n=e.depsTail,t=n!==void 0?n.nextDep:e.deps;for(;t!==void 0;)t=w(t,e)}0&&(module.exports={ReactiveFlags,computed,createReactiveSystem,effect,effectScope,endBatch,getActiveSub,getBatchDepth,isComputed,isEffect,isEffectScope,isSignal,setActiveSub,signal,startBatch,trigger});
